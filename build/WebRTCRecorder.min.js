var h=this;
function k(){function m(d,g){var a=this;g=void 0===g?n:g;this.j=document.createElement("a");this.clearSourceBuffer=function(){if(a.f)for(var b=a.f.sourceBuffers,c=0;c<b.length;c++)a.f.removeSourceBuffer(b[c]);return a};this.clearSteam=function(){if(a.b)for(var b=a.b.getTracks(),c=0;c<b.length;c++)b[c].enabled=!1,b[c].stop(),a.b.removeTrack(b[c]);return a};this.destroy=function(){a.clearSourceBuffer().clearSteam();a.c=[];return a};this.download=function(b){b=void 0===b?"untitled_"+(new Date).getTime():b;
var c=window.URL.createObjectURL(new Blob(a.c,{type:"video/"+a.options.format})),f=a.j;f.href=c;f.download=b+"."+a.options.format;document.body.appendChild(f);f.click();setTimeout(function(){document.body.removeChild(f);window.URL.revokeObjectURL(c)},0);return a};this.getBlob=function(){return new Blob(a.c,{type:"video/"+a.options.format})};this.getUrl=function(){return window.URL.createObjectURL(a.getBlob())};this.pause=function(){a.state===e.g&&a.a&&(a.a.pause(),a.state=e.paused);return a};this.resetOptions=
function(b){a.options=Object.assign({},n,b);return a.destroy().i()};this.resume=function(){a.state===e.paused&&a.a&&(a.a.resume(),a.state=e.g);return a};this.start=function(b){b=void 0===b?100:b;a.c=[];a.a=a.h();if(!a.a)return a.state=e.error,a;a.a.ondataavailable=function(c){c.data&&0<c.data.size&&a.c.push(c.data)};a.a.start(b);a.state=e.g;return a};this.stop=function(){a.state=e.stopped;a.a&&a.a.stop();return a};this.toggle=function(){a.state===e.stopped?a.start():a.state===e.g?a.stop():a.state===
e.paused&&a.resume();return a};this.i=function(){a.f=new MediaSource;a.b=a.canvas.captureStream(a.options.fps);return a};this.h=function(){var b=a.options,c=b.format;b={mimeType:"video/"+c+";codecs="+b.codecs};c={mimeType:"video/"+c};return MediaRecorder.isTypeSupported(b.mimeType)?new MediaRecorder(a.b,b):MediaRecorder.isTypeSupported(c.mimeType)?new MediaRecorder(a.b,c):!1};this.canvas=d;this.resetOptions(g)}var l;(function(d){d.VP8="vp8";d.VP9="vp9";d.Opus="Opus";d.iSAC="isac";d.iLBC="ilbc";d.H264=
"h264"})(l||(l={}));var e;(function(d){d.error="error";d.paused="paused";d.started="started";d.stopped="stopped"})(e||(e={}));var n={fps:60,format:"webm",codecs:l.l};m.isAvaliable=function(d){return MediaSource&&d.captureStream};return m}"object"===typeof exports&&"undefined"!==typeof module?module.o=k():"function"===typeof define&&define.m?define(k):(h=h||self,h.WebRTCRecorder=k());
